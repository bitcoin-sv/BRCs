# BRC-98: P Protocols: Allowing Future Wallet Protocol Permission Schemes

Ty Everett (ty@projectbabbage.com)

## Abstract

The [BRC-43](../key-derivation/0043.md) architecture for wallet protocol permissions enables a wide range of use cases. By reserving protocol identifiers and preventing their use by applications, we ensure compatibility with future standards, supporting the future development of new protocol permission schemes.

## Motivation

The motivation for this proposal is to future-proof the [BRC-43](../key-derivation/0043.md) architecture by enabling the seamless integration of new protocol permission schemes. By specifying reserved identifiers, we can ensure that new security and permission paradigms can be implemented without conflicts or unintended behavior.

## Specification

To accommodate future protocol permission schemes, wallets must reject operation requests using protocol IDs beginning with `p ` (a lowercase “p” followed by a space), regardless of security level.

### Future Scheme Identifiers

Future permission schemes must define their ID formats as follows:

- Scheme IDs cannot contain spaces.
- Protocol IDs must start with `p `, followed by the scheme ID, a space, and the rest of the protocol identifier.

#### Example Format

A protocol ID such as `p 222 xxxxx` might represent a specific invoice number (e.g., `2-p 222 xxxxx-kkkkk`), where:

- `2` represents the [BRC-43](../key-derivation/0043.md) security level.
- `p ` indicates an alternative permission scheme is being utilized.
- `222` is the identifier for the permission scheme.
- `xxxxx` is the remainder of the protocol ID under the alternative scheme.
- `kkkkk` is the key ID.

#### Protocol Parsing and Rules

Wallets must be capable of differentiating between standard and alternative permission schemes by identifying the `p ` prefix followed by the scheme ID. The scheme ID itself must be distinct and must not contain spaces to ensure unambiguous parsing.

Upon recognizing a protocol ID structured as `p <scheme ID> <rest of the ID>`, wallets may apply the specific rules defined by the scheme associated with the `scheme ID`. These rules could define:

- The allowed protocols and key IDs.
- The conditions under which operations can be executed.
- Specific counterparty requirements and other customizable permission attributes.

### Reserved Structure

To maintain clarity and prevent conflicts:

- Any protocol ID starting with `p ` must be reserved for future use.
- Wallets must refuse operations involving protocol IDs beginning with `p ` unless they explicitly support the defined scheme ID.
- A space must immediately follow the scheme ID to demarcate it from subsequent elements in the protocol ID.

### Extensibility Beyond Current Paradigms

This specification enables future permission schemes to extend beyond current [BRC-43](../key-derivation/0043.md) models, such as security levels or paradigms defined by [BRC-73](../wallet/0073.md). This flexibility supports innovative designs in wallet permissions that adapt to evolving user and application needs.

## Conclusion

By reserving protocol IDs that start with `p ` and specifying rules for future permission schemes, we enable forward compatibility and robust support for expanded wallet permission functionalities. This ensures that new schemes can be integrated without disrupting existing applications or creating parsing ambiguities.
