# BRC-94: Verifiable Shared Secret Revelation with Chaum-Pedersen Proofs

Ty Everett (ty@projectbabbage.com)

## Abstract

This BRC addresses the limitations in [BRC-69](./0069.md) Method 1 by introducing a solution that enables verifiers to confirm the correctness of a shared secret without access to private keys. The solution leverages the **Chaum-Pedersen Proof of Equality of Discrete Logarithms**, allowing a prover to demonstrate that a shared secret corresponds to their private key and the counterparty's public key. This approach ensures that the verifier can independently verify the shared secret's authenticity, enhancing trust and utility in applications requiring secure and verifiable counterparty-level key linkage revelations.

## Motivation

As identified in [BRC-93](./0093.md), **BRC-69's Method 1** has a significant limitation: verifiers cannot confirm the correctness of revealed shared secrets without knowing the prover's or counterparty's private keys. This lack of verifiability undermines the trustworthiness of the key linkage revelation, limiting its applicability in scenarios requiring independent verification.

To solve this problem, we propose using the **Chaum-Pedersen Proof of Equality of Discrete Logarithms**, a non-interactive zero-knowledge proof (NIZK) that enables the prover to prove the shared secret is correctly computed from their private key and the counterparty's public key, without revealing any private keys.

By adopting this approach, verifiers can independently confirm the correctness of shared secrets, enhancing trust and enabling broader use of BRC-69 Method 1 in privacy-preserving and trustless systems.

## Specification

### Overview of the Solution

The solution involves the prover providing a Chaum-Pedersen proof that demonstrates the equality of discrete logarithms between two commitments:

1. **Commitment 1**: The prover's public key \( P_s = k_s G \), where \( k_s \) is the prover's private key and \( G \) is the generator point.
2. **Commitment 2**: The shared secret \( S = k_s P_r \), where \( P_r \) is the counterparty's public key.

The proof shows that the prover knows a secret \( k_s \) such that:

\[ P_s = k_s G \quad \text{and} \quad S = k_s P_r \]

Without revealing \( k_s \), the prover convinces the verifier that the shared secret \( S \) is correctly computed.

### Preliminaries

- \( G \): The generator point of the secp256k1 elliptic curve.
- \( q \): The order of the group generated by \( G \).
- \( k_s \): The prover's private key (unknown to the verifier).
- \( P_s = k_s G \): The prover's public key (known to the verifier).
- \( P_r = k_r G \): The counterparty's public key (known to the verifier).
- \( S = k_s P_r \): The shared secret (revealed by the prover).
- \( N \): The curve order \( q \).

### The Chaum-Pedersen Protocol

The Chaum-Pedersen protocol allows a prover to prove that they know a secret exponent \( k_s \) such that:

\[ P_s = k_s G \quad \text{and} \quad S = k_s P_r \]

without revealing \( k_s \). The proof consists of the following steps:

#### Prover's Steps

1. **Generate Random Exponent**:
   - Choose a random \( r \in_R [1, N-1] \).

2. **Compute Commitments**:
   - \( A = r G \).
   - \( B = r P_r \).

3. **Compute Challenge**:
   - Compute the challenge \( c = H(P_s, P_r, S, A, B) \), where \( H \) is a cryptographic hash function (e.g., SHA-256) mapping to an integer modulo \( N \).

4. **Compute Response**:
   - \( z = r + c k_s \mod N \).

5. **Provide Proof**:
   - The proof consists of \( (c, z) \).

#### Verifier's Steps

1. **Recompute Commitments**:
   - \( A' = z G - c P_s \).
   - \( B' = z P_r - c S \).

2. **Compute Challenge**:
   - Compute \( c' = H(P_s, P_r, S, A', B') \).

3. **Verify Proof**:
   - Accept the proof if \( c' = c \); otherwise, reject.

### Detailed Steps

#### Prover's Algorithm

1. **Input**:
   - Prover's private key \( k_s \).
   - Counterparty's public key \( P_r \).

2. **Compute**:
   - Prover's public key \( P_s = k_s G \).
   - Shared secret \( S = k_s P_r \).

3. **Generate Random Exponent**:
   - \( r \in_R [1, N-1] \).

4. **Compute Commitments**:
   - \( A = r G \).
   - \( B = r P_r \).

5. **Compute Challenge**:
   - \( c = H_{\text{int}}(P_s, P_r, S, A, B) \),
     where \( H_{\text{int}} \) converts the hash output to an integer modulo \( N \).

6. **Compute Response**:
   - \( z = r + c k_s \mod N \).

7. **Provide Proof**:
   - \( \text{Proof} = (c, z) \).
   - Reveal \( (S, \text{Proof}) \).

#### Verifier's Algorithm

1. **Input**:
   - Prover's public key \( P_s \).
   - Counterparty's public key \( P_r \).
   - Shared secret \( S \).
   - Proof \( (c, z) \).

2. **Compute**:
   - \( A' = z G - c P_s \).
   - \( B' = z P_r - c S \).

3. **Compute Challenge**:
   - \( c' = H_{\text{int}}(P_s, P_r, S, A', B') \).

4. **Verify Proof**:
   - Accept if \( c' = c \); otherwise, reject.

### Cryptographic Hash Function

The hash function \( H \) used in the challenge computation should be collision-resistant and outputs an integer modulo \( N \). For example:

- Use SHA-256 hash function.
- Convert the hash output to an integer \( h \).
- Compute \( c = h \mod N \).

### Security Considerations

- The random exponent \( r \) must be securely generated and kept secret.
- The prover must ensure that the private key \( k_s \) remains confidential.
- The hash function \( H \) must be collision-resistant to prevent forgery.
- The proof is zero-knowledge; it does not reveal any information about \( k_s \).

By incorporating the Chaum-Pedersen Proof of Equality of Discrete Logarithms, we address the limitations in BRC-69 Method 1, allowing verifiers to independently verify the correctness of shared secrets without access to private keys. This enhancement significantly improves the trustworthiness and utility of key linkage revelations, enabling secure and verifiable interactions in privacy-preserving and trustless systems.

## References

- **Chaum-Pedersen Proof**:
  - David Chaum and Torben P. Pedersen. "Wallet Databases with Observers." *Advances in Cryptology - CRYPTO '92*, Lecture Notes in Computer Science, vol. 740, pp. 89â€“105, 1993.
- **Bitcoin Wiki**: [Zero-Knowledge Proofs](https://en.bitcoin.it/wiki/Zero_Knowledge_Proofs)